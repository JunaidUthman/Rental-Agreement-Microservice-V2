### Variables
@baseUrl = http://localhost:8083
@token101 = eyJraWQiOiI5ODZkY2M3OS02MTNiLTRhYTEtOTViYS03YWZjMjQyZDE1MGEiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIweDlmZWRlODY5MDI4MjJkNzU3OGQ0MjU3NmM1ZTliZDgyZGNlYjgxNmUiLCJhdWQiOiJhdXRoZW50aWZpY2F0aW9uLXNlcnZpY2UtY2xpZW50IiwibmJmIjoxNzY3OTc2NjIzLCJ3YWxsZXQiOiIweDlmZWRlODY5MDI4MjJkNzU3OGQ0MjU3NmM1ZTliZDgyZGNlYjgxNmUiLCJyb2xlIjoiUk9MRV9VU0VSIiwic2NvcGUiOlsid3JpdGUiLCJyZWFkIiwib3BlbmlkIiwicHJvZmlsZSJdLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjkwMDAiLCJpZCI6MiwiZXhwIjoxNzY3OTc3NTIzLCJpYXQiOjE3Njc5NzY2MjMsImp0aSI6ImQ4MzAwNDY2LTNiZDAtNDBjOC1iZTA0LWZmMDMyNjQyNGVhMSIsImVtYWlsIjoiYWhtYW5leWFoeWEwMzRAZ21haWwuY29tIn0.1tyngh_BTCVQhp-_xfNYg2Yn4fPJ7GRFncaAWmSlgdj1_PKnn7ED4DQgRakEABe0osVZeBi6smdYb0FcsnWHeMbGNXV-yEsfstmSfOu2F8VsbkAldcTXs9Fnx5cO5M4LO4ssTT4XSgAjlcbagEMJ22jSH6W6FCFuPhuhW1MPzuuej1Gf5-85uOP_Oy43QH_kpiXVpYa2FqOvDbHt40fA1bqawHUld3JL3CJ6Ri9DH79w1tnSH4O9ZWGbahOw6h1tEN5u9ETctNTBj4jLDVk3jKasE_BDuvE_e6rtGt8WlgpMHb4-TRx3DySOUz_w9benI0u76_0j7oUp3A6e_3Rm2Q
@token102 = eyJraWQiOiI5ODZkY2M3OS02MTNiLTRhYTEtOTViYS03YWZjMjQyZDE1MGEiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIweDZhNTQwMGE3NTY5NjRmODJjN2ZlMjU5Mjg1ZDRmYTA4NDIzMWQ4OTkiLCJhdWQiOiJhdXRoZW50aWZpY2F0aW9uLXNlcnZpY2UtY2xpZW50IiwibmJmIjoxNzY3OTc2NjEyLCJ3YWxsZXQiOiIweDZhNTQwMGE3NTY5NjRmODJjN2ZlMjU5Mjg1ZDRmYTA4NDIzMWQ4OTkiLCJyb2xlIjoiUk9MRV9VU0VSIiwic2NvcGUiOlsid3JpdGUiLCJyZWFkIiwib3BlbmlkIiwicHJvZmlsZSJdLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjkwMDAiLCJpZCI6MSwiZXhwIjoxNzY3OTc3NTEyLCJpYXQiOjE3Njc5NzY2MTIsImp0aSI6Ijc5ZmJlMzMyLTkwYjktNDcxZS04ZWFiLTZhNTU3YmMyNjg1OCIsImVtYWlsIjoiYWhtYW5lQGdtYWlsLmNvbSJ9.t5wpqY26vEHfAuSooYGz798piYXPIC7aujlaTOUpSywJ2rE21CHceoeMElJK11TrxjmrNghSkuL7lLZIlZBvDZT7FE2tQwC8ocTzGstxOJ5XYLwIV9_oS-hPxOUfjXoT2Ks9nh-CWGbQpACORa4okw5teEIyHMaAuD5uH8yUvZ7rp83VzEm8EV1RwU1lpSDH7xHR0KfSZy-OYtnr8zab5NnkJg1ffsvZJGF9hk2tDcbtVHqCDCr1jn3PhYwvaiYFLT5FrqVYGagbanhOs_r02b3HWmF9pg6TV6pwg-00j9AbD5LcVohLkpC0d4c49-BLcQG78nAsa-ZL3FyIMGLnag
### 1. TEST: Créer une demande de location (Tenant userId=101)
# Notification attendue: Le propriétaire (ownerId de la propriété) devrait recevoir RENTAL_REQUEST_CREATED
POST {{baseUrl}}/api/rentalAgreement-microservice/rental-requests
Content-Type: application/json
Authorization: Bearer {{token102}}

{
  "propertyId": 1
}

###

### 2. TEST: Accepter une demande (Owner)
# Notifications attendues:
# - Le tenant (userId=101) reçoit RENTAL_REQUEST_ACCEPTED
# - Les autres tenants en attente reçoivent RENTAL_REQUEST_REJECTED
PUT {{baseUrl}}/api/rentalAgreement-microservice/rental-requests/1/status
Content-Type: application/json
Authorization: Bearer {{token101}}

{
  "status": "ACCEPTED"
}

###

### 3. TEST: Refuser une demande (Owner)
# Notification attendue: Le tenant (userId=101) reçoit RENTAL_REQUEST_REJECTED
PUT {{baseUrl}}/api/rentalAgreement-microservice/rental-requests/1/status
Content-Type: application/json
Authorization: Bearer {{token102}}

{
  "status": "REJECTED"
}

###

### 4. TEST: Créer un contrat (Tenant userId=101)
# Notifications attendues:
# - Le propriétaire (ownerId) reçoit CONTRACT_CREATED
# - Le tenant (userId=101) reçoit CONTRACT_CREATED
POST {{baseUrl}}/api/rentalAgreement-microservice/rental-contracts
Content-Type: application/json
Authorization: Bearer {{token101}}

{
  "agreementIdOnChain": 12345,
  "ownerId": 102,
  "propertyId": 1,
  "securityDeposit": 1000.0,
  "rentAmount": 500.0,
  "startDate": "2025-01-01",
  "endDate": "2025-12-31"
}

###

### 5. TEST: Confirmer la remise des clés (Tenant userId=101)
# Notification attendue: Le propriétaire (ownerId) reçoit KEY_DELIVERED
PUT {{baseUrl}}/api/rentalAgreement-microservice/rental-contracts/1/key-delivery
Content-Type: application/json
Authorization: Bearer {{token101}}

{
  "isKeyDelivered": true
}

###